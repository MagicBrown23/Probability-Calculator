<!DOCTYPE html>
<html>
<head>
  <title>AACAAN Probability Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #232526, #414345);
      color: white;
      padding: 40px;
    }
    h1 {
      text-align: center;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    select, input {
      margin-top: 5px;
      padding: 5px;
      font-size: 16px;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      font-size: 16px;
      background-color: #1abc9c;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #16a085;
    }
    #result {
      margin-top: 30px;
      font-size: 18px;
      background-color: rgba(255,255,255,0.1);
      padding: 15px;
      border-radius: 10px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>Studying of card probabilities in specific positions</h1>

  <div id="bottomCardSection">
    <label for="bottomCard">Select the current bottom card:</label>
    <select id="bottomCard" onchange="hideBottomCard()"></select>
  </div>

  <label for="namedCard">Select the named card:</label>
  <select id="namedCard"></select>

  <label for="namedNumber">Enter the named number (1–52):</label>
  <input type="number" id="namedNumber" min="1" max="52">

  <button onclick="calculate()">Calculate</button>

  <div id="result"></div>

  <script>
    const mnemonica = [
      "4♣", "2♥", "7♦", "3♣", "4♥", "6♦", "A♠", "5♥", "9♠", "2♠",
      "Q♥", "3♦", "Q♣", "8♥", "6♠", "5♠", "9♥", "K♣", "2♦", "J♥",
      "3♠", "8♠", "6♥", "10♣", "5♦", "K♦", "2♣", "3♥", "8♦", "5♣",
      "K♠", "J♦", "8♣", "10♠", "K♥", "J♣", "7♠", "10♥", "A♦", "4♠",
      "7♥", "4♦", "A♣", "9♣", "J♠", "Q♦", "7♣", "Q♠", "10♦", "6♣",
      "A♥", "9♦"
    ];

    const suits = ["♦", "♣", "♥", "♠"];
    const values = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];

    const namedCardSelect = document.getElementById("namedCard");
    const bottomCardSelect = document.getElementById("bottomCard");

    let storedBottomCard = null; // This holds the hidden bottom card after selection

    function populateCards(select) {
      for (let s = 0; s < suits.length; s++) {
        for (let v = 0; v < values.length; v++) {
          let card = values[v] + suits[s];
          let option = document.createElement("option");
          option.value = card;
          option.text = card;
          select.appendChild(option);
        }
      }
    }

    populateCards(namedCardSelect);
    populateCards(bottomCardSelect);

    function cardToMnemonicaPos(card) {
      return mnemonica.indexOf(card) + 1;
    }

    function cardToSecretCode(card) {
      let suitChar = card.slice(-1);
      let rankStr = card.slice(0, -1);
      let suitCode = { "♦": 1, "♣": 2, "♥": 3, "♠": 4 }[suitChar];
      let rankCode = { "A": 1, "J": 11, "Q": 12, "K": 13 }[rankStr] || parseInt(rankStr);
      return suitCode * 100 + rankCode;
    }

    function hideBottomCard() {
      storedBottomCard = bottomCardSelect.value;
      document.getElementById("bottomCardSection").classList.add("hidden");
    }

    function calculate() {
      const namedCard = namedCardSelect.value;
      const namedNumber = parseInt(document.getElementById("namedNumber").value);

      if (!namedCard || !storedBottomCard || isNaN(namedNumber)) {
        document.getElementById("result").innerText = "Please complete all inputs.";
        return;
      }

      const namedPos = cardToMnemonicaPos(namedCard);
      const bottomPos = cardToMnemonicaPos(storedBottomCard);

      let targetPos = namedPos - namedNumber;
      if (targetPos < 1) targetPos += 52;

      const targetCard = mnemonica[targetPos - 1];

      let finalPos = targetPos - bottomPos;
      if (finalPos < 1) finalPos += 52;

      const probability = (finalPos < 10 ? "0" : "") + finalPos;
      const secretCode = cardToSecretCode(targetCard);

      document.getElementById("result").innerText =
        `The probability of your card in that position is 0.${probability}% and only ${secretCode} out of 10000 people have named this combination`;
    }
  </script>
</body>
</html>
